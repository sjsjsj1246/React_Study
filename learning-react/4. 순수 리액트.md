# 4 순수 리액트

## 4.1 페이지 설정

리액트가 브라우저에서 어떻게 실행되는지 이해하기 위해 이 장에서는 순수 리액트만 활용해 진행할 것이다. JSX는 다음 장에서 소개한다. 리액트 내부에서 어떤 일이 벌어지는지 이해하기 위해 시간을 투자한다면 더 효율적인 리액트 프로그래머가 될 수 있다. 리액트 코드를 디버깅해야 하는 경우 특히 더 그렇다. 이 장의 목표는 리액트 내부를 들여다보고 리액트가 어떻게 작동하는지 이해하는 것이다.  

## 4.1 페이지 설정

리액트를 브라우저에서 다루려면 React와 ReactDom 라이브러리를 불러와야 한다. React는 뷰를 만들기 위한 라이브러리고 ReactDOM은 UI를 실제로 브라우저에 렌더링할 떄 사용하는 라이브러리다.  

## 4.2 가상 DOM

HTML은 브라우저가 문서 객체 모들(DOM)을 구성하기 위해 따라야 하는 절차라고 간단히 말할 수 있다. HTML 문서를 이루는 엘리먼트는 브라우저가 HTML 문서를 읽어 들이면 DOM 엘리먼트가 되고, 이 DOM이 화면에 사용자 인터페이스를 표시한다.  

어떤 조리법을 표시하기 위한 HTML 계층 구조를 만들었다고 하자. 한 가지 가능한 예를 들면 다음과 비슷할 것이다.  
```html
<section id="baked-salmon">
        <h1>Baked Salmon</h1>
        <ul class="ingredients">
            <li>1 lb Salmon</li>
            <li>1 cup Pine Nuts</li>
            <li>2 cups Butter Lettuce</li>
            <li>1 Yellow Squash</li>
            <li>1/2 cup Olive Oil</li>
            <li>3 cloves of Garlic</li>
        </ul>
        <section class="instructions">
            <h2>Cooking Instructions</h2>
            <p>Preheat the oven to 350 degrees.</p>
            <p>Spread the olive oil around a glass baking dish.</p>
            <p>Add the salmon, garlic, and pine nuts to the dish.</p>
            <p>Bake for 15 minutes.</p>
            <p>Add the yellow squash and put back in the oven for 30 mins.</p>
            <p>Remove from oven and let cool for 15 minutes. Add the lettuce and serve.</p>
        </section>
    </section>
```
HTML에서 앨리먼트는 가계도를 닮은 계층구조 안에서 서로 관계가 있다. 여기서는 루트 엘리먼트 아래에 제목(heading), 번호를 붙이지 않은 재료 리스트, 조리 절차 섹션이라는 세 자식이 있다고 할 수 있다.  

전통적으로 웹사이트는 독맂벅인 HTML 페이지들로 만들어졌다. 사용자가 페이지 사이를 내비게이션하면 브라우저는 매번 다른 HTML 문서를 요청해서 로딩한다. AJAX가 생기면서 단일 페이지 앱(SPA)이 생겼다. 브라우저가 AJAX를 사용해 아주 작은 데이터를 요청해서 가져올 수 있게 됨에 따라 이제는 전체 웹 애플리케이션이 한페이지로 실행되면서 자바스크립트에 의존해 사용자 인터페이스를 갱신할 수 있게 됐다.  

SPA에서 처음에 브라우저는 HTML문서를 하나 적재한다. 사용자는 사이트를 내비게이션하지만 실제로는 같은 페이지 안에 계속 머문다. 자바스크립트 사용자가 애플리케이션과 상호작용 하는 것에 맞춰 표시 중이던 인터페이스를 없애고 새로운 사용자 인터페이스를 만든다. 사용자가 느끼기에는 한 페이지에서 다른 페이지로 이동한 것 같지만 실제로는 여전히 같은 HTML 페이지 안에 머물 뿐이고 자바스크립트가 모든 힘든 처리를 대신 해준다.  

DOM API는 브라우저의 DOM을 변경하기 위해 자바스크립트가 사용할 수 있는 개체의 모음이다. document.createElement나 document.appendChild를 써봤다면 이미 DOM을 써본 것이다. 화면에 표시된 DOM 엘리먼트를 자바스크립트로 갱신하거나 변경하는 것은 상대적으로 쉽다. 하지만 새 엘리먼트를 추가하려면 시간이 엄청나게 오래 걸린다. 이는 웹 개발자가 UI를 변경하는 방법을 세밀하고 정확하게 신경써야 애플리케이션 성능을 향상시킬 수 있다는 뜻이다.  

자바스크립트를 사용해 DOM 변경을 효율적으로 처리하는 일은 아주 복잡하고 시간이 오래 걸리는 일이다. 코딩 관점에서 볼 때는 특정 엘리먼트의 모든 자식을 삭제하고 새 자식을 생성해 넣는 일이 이미 존재하는 자식들을 효율적으로 갱신하려 시도하는 일보다 더 쉽고 깔끔하다. 문제는 새로운 애플리케이션을 만들 때마다 그 애플리케이션이 DOM API를 효율적으로 사용하게 만들 수 있는 고급 지식이나 시간이 우리에게 없다는 점이다. 이에 대한 해법이 리액트다.  

리액트는 브라우저 DOM을 갱신하기 위해 만든 라이브러리다. 리액트가 모든 처리를 대신 해주기 때문에 더 이상 SPA를 효율적으로 만들기 위해 여러 복잡한 내용을 신경 쓸 필요 없다.  

우리는 DOM API를 직접 조작하지 않는다. 대신 가상 DOM을 다루거나 리액트가 UI를 생성하고 브라우저와 상호작용하기 위해 사용하는 몇 가지 명령을 다룬다.  

가상 DOM은 리액트 엘리먼트로 이루어진다. 리액트 엘리먼트는 개념상 HTML 엘리먼트와 비슷하지만 실제로는 자바스크립트 객체다. DOM API를 직접 다루는 것보다 자바스크립트 객체인 가상 DOM을 직접 다루는 편이 훨씬 빠르다. 우리가 가상 DOM을 변경하면 리액트는 DOM API를 사용해 변경사항을 효율적으로 랜더링해준다.  

## 4.3 리액트 엘리먼트

브라우저 DMO은 DOM 엘리먼트로 이루어진다. 마찬가지로 리액트 DOM은 리액트 엘리먼트로 이루어진다. DOM 엘리먼트와 리액트 엘리먼트의 겉모습은 비슷해 보일지 몰라도 그 실체는 상당히 다르다. 리액트 엘리먼트는 그에 대응하는 실제 DOM 엘리먼트가 어떻게 생겨야 하는지 기술한다. 다시 말해 리액트 엘리먼트는 브라우저 DOM을 만드는 방법을 알려주는 명령이다.  

React.creatElement를 사용해 h1을 표현하는 리액트 엘리먼트를 만들 수 있다.   
```js
React.creatElement("h1", null, "구운 연어")
```
첫 번째 인자는 만들려는 엘리먼트의 타입을 정의한다. 여기서는 h1 엘리먼트를 만든다. 세 뻔째 인자는 여는 태그와 닫는 태그 사이에 들어가야 할 엘리먼트의 자식 노드를 표현한다. 두 번째 인자는 엘리먼트의 프로퍼티를 표현한다. 여기서 만드는 h1에는 프로퍼티가 없다.  

렌더링 과정에서 리액트는 다음 엘리먼트를 실제 DOM 엘리먼트로 변환한다.  
```html
<h1>Baked Salmon</h1>
```

